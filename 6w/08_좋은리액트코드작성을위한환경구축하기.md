# 08. 좋은 리액트 코드 작성을 위한 환경 구축하기

## 8.1 ESLint 를 활용한 정적 코드 분석

### 8.1.1 ESLint 살펴보기

#### ESLint 는 어떻게 코드를 분석할까?

1. JS 를 문자열로 읽는다
2. JS 를 분석할 수 있는 Parser 인 espee 를 사용하여 코드를 구조화 한다
3. 2번에서 구조화한 트리(Abstract Syntax Tree)를 기준으로 각종 규칙을 대조
4. 규칙과 대조했을 때 이를 위반한 코드를 Report or Fix

### 8.1.2 eslint-plugin 과 eslint-config

#### eslint-plugin

- 다양한 ESLint 규칙을 모아놓은 패키지

#### eslint-config

- ESLint 관련 설정을 제공하는 패키지

##### eslint-config-airbnb

- Airbnb 에서 만들었으며, 500여 명의 개발자가 유지보수하는 가장 유명한 규칙

##### @@titicaca/triple-config-kit

- 트리플에서 유지 관리하는 패키지
- Airbnb 의 룰을 따르지 않고, 기본적인 규칙을 제공

##### eslint-config-next

- Next.js 를 위한 듀칙 제공

### 8.1.3 나만의 ESLint 규칙 만들기

#### Import React 를 제거하기 위한 ESLint 규칙 만들기

```js
module.exports = {
  rules: {
    "no-restrict-imports": [
      "error",
      {
        paths: [
          {
            name: "react",
            importNames: ["default"],
            message: "Import React from 'react'는 17버전 부터 필요 없습니다!",
          },
        ],
      },
    ],
  },
};
```

#### 완전히 새로운 규칙 만들기: new Date 를 금지시키는 규칙

```js
/** * @type {import('eslint').Rule.RuleModule} */ module.exports = {
  meta: {
    type: "suggestion",
    docs: { description: "disallow use of the new Date()", recommended: false },
    fixable: "code",
    schema: [],
    messages: {
      message:
        "new Date()는 클라이언트에서 실행 시 해당 기기의 시간에 의존적이라 정확하지 않습니다. 현재 시간이 필요하다면 ServerDate()를 사용해 주세요.",
    },
  },
  create: function (context) {
    return {
      NewExpression: function (node) {
        if (node.callee.name === "Date" && node.arguments.length === 0) {
          context.report({
            node: node,
            messageId: "message",
            fix: function (fixer) {
              return fixer.replaceText(node, "ServerDate()");
            },
          });
        }
      },
    };
  },
};
```

### 8.1.4 주의할 점

#### Prettier 와의 충돌

#### 규칙에 대한 예외 처리, 그리고 React-hooks/no-exhaustive-deps

- 일부 코드에서 특정 규칙을 임시로 제외시키고 싶다면, eslint-disable-주석 사용 필요

```js
// 특정 줄만 제외
console.log("hello world"); // eslint-disable-line no-console

// 다음 줄 제외
// eslint-disable-next-line no-console
console.log("hello world");

// 특정 여러 줄 제외
/* eslint-disable no-console */
console.log("JavaScript debug log");
console.log("eslint is disabled now");
/* eslint-enable no-console */

// 파일 전체에서 제외
/* eslint-disable no-console */
console.log("hello world");
```

- useEffect 나 useMemo 의 의존성 배열을 예외 처리하는 eslint-disable-line no-exhaustive-deps 를 자주 사용할 가능성이 높은데 잠재적 버그 유발이 가능하므로 주의가 필요하다.
- 그 외에 type-script 에서 any 를 강제로 사용하기 위한 typescript-eslint/no-explicit-any 도 마찬가지다

#### ESLint 의 버전 충돌

- 서로 다른 버전의 ESLint 가 설치 되어 있으면, 에러가 발생하므로 ESLint 의 의존성을 배포 의존성(peerDependecies)로 설정해 두는 것을 권장

### 8.1.5 정리

- 버그 예방, 공통된 코드 스타일 등등 사용을 권장
- 사용은 안하더라도 사용법은 알아 둘 것!
